"use strict";(self.webpackChunktravex=self.webpackChunktravex||[]).push([[871],{3131:function(e,t,n){n.d(t,{_N:function(){return a},x9:function(){return o}});var r=n(9085),i={autoClose:2e3,className:"",position:r.Am.POSITION.TOP_RIGHT},o=function(e){r.Am.success(e,i)},a=function(e){r.Am.error(e,i)}},126:function(e,t){t.Z=Object.freeze({LOGIN:"/api/login",CREATE_USER:"/api/register",CREATE_BUSINESS:"/api/business/register",PROFILE:"/api/profile",USERS:"/api/masteradmin/users",LOCATION:function(e){return"/api/locations/".concat(e)},MASTER_LOCATIONS:"/api/admin/locations",CREATE_LOCATION_BY_MASTER_ADMIN:"/api/masteradmin/locations",MY_LOCATION:"/api/profile/locations",APPROVE_LOCATION:function(e){return"/api/locations/".concat(e,"/approve")},ADD_REVIEW:function(e){return"/api/locations/".concat(e,"/reviews")},APPROVE_REVIEW:function(e){return"/api/locations/".concat(e,"/reviews/approveReview")},ADD_REPLY:function(e){return"/api/locations/".concat(e,"/reviews/addComment")},APPROVE_REPLY:function(e){return"/api/locations/".concat(e,"/comments/approveReply")}})},4918:function(e,t,n){n.d(t,{J:function(){return c},z:function(){return l}});var r=n(4165),i=n(5861),o=n(8669),a=n(126),s=n(2917),u=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n,i){var s,u,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="master_admin"===i?a.Z.MASTER_LOCATIONS:"".concat(a.Z.LOCATION(t),"?search=").concat(n),e.next=3,o.Z.get(s);case 3:return u=e.sent,c=u.data,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return(0,s.a)(["listings",e,t,n],(function(){return u(e,t,n)}),r)},d=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var t,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.get(a.Z.MY_LOCATION);case 2:return t=e.sent,n=t.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.a)(["my-listings"],d,e)}},2039:function(e,t,n){n.d(t,{U:function(){return c},q:function(){return l}});var r=n(4165),i=n(5861),o=n(8669),a=n(126),s=n(2917),u=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var t,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.get(a.Z.PROFILE);case 2:return t=e.sent,n=t.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.a)(["profile"],u,e)},d=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var t,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.get(a.Z.USERS);case 2:return t=e.sent,n=t.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.a)(["users"],d,e)}},4871:function(e,t,n){n.r(t),n.d(t,{default:function(){return N}});var r=n(2791),i=n(4087),o=n(896),a=n(176),s=n(1483),u=n(2893),c=n(7908),d=n(4918),l=n(7689),p=n(9352),v=n(3433),x=n(9439),h=n(6036),f=n(184),m=function(e){var t=e.id,n=e.value,i=e.onChangeRating,o=void 0===i?function(){}:i,a=(0,r.useState)(n),s=(0,x.Z)(a,2),u=s[0],c=s[1],d=(0,r.useState)(0),l=(0,x.Z)(d,2),p=l[0],m=l[1];return(0,f.jsx)("div",{className:"star-rating",children:(0,v.Z)(Array(5)).map((function(e,r){return r+=1,(0,f.jsx)("button",{type:"button",id:t,className:r<=(p||u||n)?"on":"off",onClick:function(){n||(c(r),o(r))},onMouseEnter:function(){n||m(r)},onMouseLeave:function(){n||m(u)},disabled:n,children:(0,f.jsx)(h.DQk,{className:"star"})},r)}))})},g=n(2039),b=n(4925),w=n(6403),y=n(3418),R=n(8669),j=n(126),A=n(3131),I=["mutate"],Z=["mutate"],S=n(5705),L=["mutate"],E=["mutate"],_=["mutate"];function N(){var e=(0,l.UO)().id,t=(0,d.J)(e),n=t.data,r=t.isLoading,s=t.isError,u=(0,g.U)(),v=u.data,x=u.isLoading;return r||x?(0,f.jsx)(c.aN,{height:"600px"}):s?(0,f.jsx)(c.ub,{heading:"Ooops an error occured!",bg:"white"}):(0,f.jsxs)(i.xu,{children:[(0,f.jsx)(O,{data:n}),(0,f.jsx)(o.M,{children:(0,f.jsxs)(a.k,{flexDirection:"column",alignItems:"center",justifyContent:"center",width:"80%",position:"absolute",top:{base:"380px",md:"480px"},bg:"white",borderRadius:"10px",border:"1px solid ".concat(p.Z.gray[200]),py:{base:"20px",md:"60px"},children:[(0,f.jsx)(T,{locationId:e,user:v,data:n}),(0,f.jsx)(C,{locationId:e,user:v,data:n})]})})]})}var O=function(e){var t=e.data;return(0,f.jsxs)(a.k,{flexDirection:"column",alignItems:"center",justifyContent:"flex-end",width:"100%",position:"relative",children:[(0,f.jsx)(s.E,{bg:"gray.400",src:null===t||void 0===t?void 0:t.Image,alt:null===t||void 0===t?void 0:t.Name,width:"100%",height:{base:"300px",md:"400px"},objectFit:"cover"}),(0,f.jsx)(i.xu,{bg:"rgba(0,0,0,0.4)",position:"absolute",top:0,width:"100%",height:{base:"300px",md:"400px"}})]})},T=function(e){var t=e.locationId,n=e.data,r=e.user,o=function(e){var t=(0,w.NL)(),n=(0,y.D)((function(t){return R.Z.patch(j.Z.APPROVE_LOCATION(e),t)})),r=n.mutate;return{approveListing:function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};r(n,{onSuccess:function(n){(0,A.x9)(n.message),t.invalidateQueries(["listings",e]),t.invalidateQueries(["listings",""]),i(n)},onError:function(e){(0,A._N)(e.message)}})},approveListingState:(0,b.Z)(n,_)}}(t),s=o.approveListing,u=o.approveListingState;return(0,f.jsxs)(c.Zb,{border:"1px solid ".concat(p.Z.gray[100]),width:"86%",p:{base:"20px 24px",md:"40px 48px"},bg:"white",borderRadius:"10px",alignItems:"flex-start",children:[(0,f.jsxs)(a.k,{direction:"row",justify:"space-between",width:"100%",pb:"8px",children:[(0,f.jsxs)(i.xu,{children:[(0,f.jsx)(c.ZT,{textStyle:"10",fontWeight:700,color:"gray.400",pb:"4px",children:null===n||void 0===n?void 0:n.Name}),"master_admin"===r.Role&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(c.ZT,{textStyle:"14",fontWeight:500,color:"gray.400",pb:"4px",children:["Type: ",null===n||void 0===n?void 0:n.LocationType.Name]}),(0,f.jsxs)(c.ZT,{textStyle:"14",fontWeight:500,color:"gray.400",pb:"18px",children:["Author: ",null===n||void 0===n?void 0:n.User.First_name," ",null===n||void 0===n?void 0:n.User.Last_name]})]})]}),"master_admin"===r.Role&&(0,f.jsx)(c.zx,{mode:n.IsApproved?"secondary":"primary",bg:n.IsApproved?"warning.500":"success.500",_hover:{bg:n.IsApproved?"warning.600":"success.600"},_focus:{bg:n.IsApproved?"warning.600":"success.600"},size:"md",type:"btn",isDisabled:u.isLoading,isLoading:u.isLoading,onClick:function(){s({isApproved:n.IsApproved?0:1})},children:n.IsApproved?"Unpublish":"Publish"})]}),(0,f.jsx)(c.ZT,{textStyle:"12",color:"gray.300",children:null===n||void 0===n?void 0:n.Description})]})},C=function(e){var t,n,r=e.locationId,o=e.user,s=e.data,d=function(e){var t=(0,w.NL)(),n=(0,y.D)((function(t){return R.Z.post(j.Z.ADD_REVIEW(e),t)})),r=n.mutate;return{addReview:function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};n.rating<=0?(0,A._N)("You must add a rating"):r(n,{onSuccess:function(n){(0,A.x9)(n.message),t.invalidateQueries(["listings",e]),i(n)},onError:function(e){(0,A._N)(e.message)}})},addReviewState:(0,b.Z)(n,I)}}(r),l=d.addReview,v=d.addReviewState,x=function(e){var t=(0,w.NL)(),n=(0,y.D)((function(t){return R.Z.patch(j.Z.APPROVE_REVIEW(e),t)})),r=n.mutate;return{approveReview:function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};r(n,{onSuccess:function(n){(0,A.x9)(n.message),t.invalidateQueries(["listings",e]),i(n)},onError:function(e){(0,A._N)(e.message)}})},approveReviewState:(0,b.Z)(n,Z)}}(r),h=x.approveReview,g=x.approveReviewState,_=function(e){var t=(0,w.NL)(),n=(0,y.D)((function(t){return R.Z.post(j.Z.ADD_REPLY(e),t)})),r=n.mutate;return{addReply:function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};r(n,{onSuccess:function(n){(0,A.x9)(n.message),t.invalidateQueries(["listings",e]),i(n)},onError:function(e){(0,A._N)(e.message)}})},addReplyState:(0,b.Z)(n,L)}}(r),N=_.addReply,O=_.addReplyState,T=function(e){var t=(0,w.NL)(),n=(0,y.D)((function(t){return R.Z.patch(j.Z.APPROVE_REPLY(e),t)})),r=n.mutate;return{approveReply:function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};r(n,{onSuccess:function(n){(0,A.x9)(n.message),t.invalidateQueries(["listings",e]),i(n)},onError:function(e){(0,A._N)(e.message)}})},approveReplyState:(0,b.Z)(n,E)}}(r),C=T.approveReply,P=T.approveReplyState,D=(0,S.TA)({initialValues:{rating:0,comment:""},onSubmit:function(e){l(e)}}),k=(0,S.TA)({initialValues:{text:"",reviewId:""},onSubmit:function(e){N(e,(function(){k.resetForm({text:"",reviewId:""})}))}});return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(c.ZT,{textStyle:"10",fontWeight:700,textAlign:"left",color:"gray.400",width:"86%",p:{base:"20px 24px",md:"40px 48px"},children:["Customer Reviews (",null===s||void 0===s||null===(t=s.Reviews)||void 0===t?void 0:t.length,")"]}),(null===s||void 0===s||null===(n=s.Reviews)||void 0===n?void 0:n.length)<=0?(0,f.jsx)(i.xu,{width:"86%",children:(0,f.jsx)(c.ub,{height:"200px",maxWidth:"100%",heading:"No Data!",message:"admin"===o.Role?"You currently have no reviews for this listing":"There are no reviews available for this listing at the moment"})}):null===s||void 0===s?void 0:s.Reviews.map((function(e){var t;return(0,f.jsx)(c.Zb,{border:"1px solid ".concat(p.Z.gray[100]),width:"86%",p:{base:"20px 24px",md:"40px 48px"},bg:"white",borderRadius:"10px",alignItems:"flex-start",mb:{base:"20px",md:"40px"},children:(0,f.jsxs)("form",{onSubmit:function(e){e.preventDefault(),k.handleSubmit(e)},id:"reply",style:{width:"100%"},children:[(0,f.jsxs)(u.U,{spacing:"8px",align:"flex-start",children:[(0,f.jsxs)(i.xu,{children:[(0,f.jsx)(c.ZT,{textStyle:"11",fontWeight:700,color:"gray.400",children:"".concat(e.Author.First_name," ").concat(e.Author.Last_name)}),(0,f.jsx)(m,{value:Number(5*e.Rating)})]}),(0,f.jsxs)(u.U,{as:"sup",children:["admin"===o.Role&&(0,f.jsx)(c.zx,{variant:"unstyled",boxShadow:"none",fontSize:"12px",type:"button",size:"sm",width:"auto",color:e.IsApproved?"error.400":"success.500",onClick:function(){return h({reviewId:e.Id,isApproved:e.IsApproved?0:1})},isDisabled:g.isLoading,children:e.IsApproved?"Unapprove this comment":"Approve this comment"}),e.IsApproved&&(0,f.jsx)(c.zx,{mode:"secondary",variant:"unstyled",boxShadow:"none",fontSize:"12px",type:"button",size:"sm",width:"auto",onClick:function(){""===k.values.reviewId?k.setValues({text:k.values.text,reviewId:e.Id}):k.setValues({text:"",reviewId:""})},children:""===k.values.reviewId?"Reply":"Cancel"})]})]}),(0,f.jsx)(c.ZT,{textStyle:"12",color:"gray.300",children:e.Text}),null===e||void 0===e?void 0:e.Comments.map((function(e){return(0,f.jsxs)(u.U,{spacing:"8px",align:"flex-start",children:[(0,f.jsxs)(i.xu,{ml:"20px",mt:"10px",children:[(0,f.jsx)(c.ZT,{textStyle:"12",fontWeight:700,color:"gray.400",children:"".concat(e.Author.First_name," ").concat(e.Author.Last_name)}),(0,f.jsx)(c.ZT,{textStyle:"12",color:"gray.300",children:e.Text})]}),"admin"===o.Role&&(0,f.jsx)(i.xu,{as:"sup",children:(0,f.jsx)(c.zx,{variant:"unstyled",boxShadow:"none",fontSize:"12px",type:"button",size:"sm",width:"auto",color:e.IsApproved?"error.400":"success.500",onClick:function(){return C({commentId:e.Id,isApproved:e.IsApproved?0:1})},isDisabled:P.isLoading,children:e.IsApproved?"Unapprove this comment":"Approve this comment"})})]},e.Id)})),e.IsApproved&&k.values.reviewId===e.Id&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(c.gx,{mt:"10px",id:"text",placeholder:"Add your reply here",minH:"150px",onChange:k.handleChange,onBlur:k.handleBlur,value:k.values.text}),(0,f.jsx)(a.k,{justifyContent:"flex-end",children:(0,f.jsx)(c.zx,{mode:"secondary",variant:"solid",size:"md",mt:35,type:"submit",isDisabled:k.isLoading||(null===(t=k.values.text)||void 0===t?void 0:t.length)<=0,isLoading:O.isLoading,children:"Add Reply"})})]})]})},e.Id)}))]}),null!==s&&void 0!==s&&s.Reviews.find((function(e){return e.Author_id===o.Id}))||"admin"===o.Role||"master_admin"===o.Role||(null===s||void 0===s?void 0:s.User.Id)===o.Id?null:(0,f.jsx)(c.Zb,{border:"1px solid ".concat(p.Z.gray[100]),width:"86%",p:{base:"20px 24px",md:"40px 48px"},bg:"white",borderRadius:"10px",alignItems:"flex-start",mt:{base:"20px",md:"40px"},children:(0,f.jsxs)("form",{onSubmit:function(e){e.preventDefault(),D.handleSubmit(e)},id:"add-review",style:{width:"100%"},children:[(0,f.jsx)(c.ZT,{textStyle:"11",fontWeight:700,color:"gray.400",mb:"12px",children:"Add Review"}),(0,f.jsx)(m,{id:"rating",onChangeRating:function(e){return D.setFieldValue("rating",2*e)},onBlur:D.handleBlur}),(0,f.jsx)(c.gx,{mt:"10px",id:"comment",placeholder:"Add your review or experience here",minH:"150px",onChange:D.handleChange,onBlur:D.handleBlur,value:D.values.comment}),(0,f.jsx)(a.k,{justifyContent:"flex-end",children:(0,f.jsx)(c.zx,{mode:"secondary",variant:"solid",size:"md",mt:35,type:"submit",isDisabled:v.isLoading||D.values.rating<=0,isLoading:v.isLoading,children:"Add"})})]})})]})}},8669:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(3263),i=n(691),o=n.n(i),a=n(1986),s=r.Z.create({baseURL:"https://www.travexapitest.co.uk"});function u(e){return e.results?Promise.resolve(e.results):e.data?Promise.resolve(e.data):Promise.resolve(e)}s.interceptors.request.use((function(e){var t=(0,a.bW)();return t&&!e.headers.hasOwnProperty("Authorization")&&(e.headers.Authorization="Bearer ".concat(t)),e})),s.interceptors.request.use((function(e){return o().start(),e})),s.interceptors.response.use((function(e){return o().done(),e}),(function(e){if(o().done(),e.response&&e.response.data&&e.response.data.message)if(401===e.response.status)e={response:{data:e.response.data}},(0,a.H6)();else if(404===e.response.status)e={response:{data:e.response.data}};else{if(500!==e.response.status)return Promise.reject(e);e={response:{data:{message:"Ooops! an error occurred"}}}}else e={response:{data:{message:"Unable to complete request"}}};throw e}));function c(e){return e.data?Promise.reject(e.data):e.response.data?Promise.reject(e.response.data):Promise.reject(e)}var d={get:function(e){return s.get(e).then(u).catch(c)},post:function(e,t,n){return s.post(e,t,n).then(u).catch(c)},put:function(e,t){return s.put(e,t).then(u).catch(c)},patch:function(e,t){return s.patch(e,t).then(u).catch(c)},remove:function(e,t){return s.delete(e,t).then(u).catch(c)}}}}]);
//# sourceMappingURL=871.ab2745a2.chunk.js.map